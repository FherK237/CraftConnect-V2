var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
import { getRequestBody } from "../../../../../src/management/core/fetcher/getRequestBody.mjs";
import { RUNTIME } from "../../../../../src/management/core/runtime/index.mjs";
describe("Test getRequestBody", () => {
    it("should stringify body if not FormData in Node environment", () => __awaiter(void 0, void 0, void 0, function* () {
        if (RUNTIME.type === "node") {
            const body = { key: "value" };
            const result = yield getRequestBody({
                body,
                type: "json",
            });
            expect(result).toBe('{"key":"value"}');
        }
    }));
    it("should return FormData in browser environment", () => __awaiter(void 0, void 0, void 0, function* () {
        if (RUNTIME.type === "browser") {
            const formData = new FormData();
            formData.append("key", "value");
            const result = yield getRequestBody({
                body: formData,
                type: "file",
            });
            expect(result).toBe(formData);
        }
    }));
    it("should stringify body if not FormData in browser environment", () => __awaiter(void 0, void 0, void 0, function* () {
        if (RUNTIME.type === "browser") {
            const body = { key: "value" };
            const result = yield getRequestBody({
                body,
                type: "json",
            });
            expect(result).toBe('{"key":"value"}');
        }
    }));
    it("should return the Uint8Array", () => __awaiter(void 0, void 0, void 0, function* () {
        const input = new Uint8Array([1, 2, 3]);
        const result = yield getRequestBody({
            body: input,
            type: "bytes",
        });
        expect(result).toBe(input);
    }));
    it("should return the input for content-type 'application/x-www-form-urlencoded'", () => __awaiter(void 0, void 0, void 0, function* () {
        const input = "key=value&another=param";
        const result = yield getRequestBody({
            body: input,
            type: "other",
        });
        expect(result).toBe(input);
    }));
    it("should JSON stringify objects", () => __awaiter(void 0, void 0, void 0, function* () {
        const input = { key: "value" };
        const result = yield getRequestBody({
            body: input,
            type: "json",
        });
        expect(result).toBe('{"key":"value"}');
    }));
});
